{% extends "base.html" %}
{% block content %}

<h2>Knowledge sources</h2>
<p>These are the documents and imports that feed your TheoChat assistant.</p>

{% if items %}
  <table class="table" style="width:100%;border-collapse:collapse;margin-top:0.75rem;">
    <thead>
      <tr style="text-align:left;border-bottom:1px solid var(--border);">
        <th style="padding:0.5rem 0.25rem;">Label</th>
        <th style="padding:0.5rem 0.25rem;">Filename</th>
        <th style="padding:0.5rem 0.25rem;">Chunks</th>
        <th style="padding:0.5rem 0.25rem;">Uploaded</th>
        <th style="padding:0.5rem 0.25rem;">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for row in items %}
        <tr style="border-bottom:1px solid var(--border);">
          <td style="padding:0.5rem 0.25rem;">{{ row["label"] }}</td>
          <td style="padding:0.5rem 0.25rem;">{{ row["filename"] }}</td>
          <td style="padding:0.5rem 0.25rem;">{{ row["chunk_count"] }}</td>
          <td style="padding:0.5rem 0.25rem;">{{ row["first_uploaded"] }}</td>
          <td style="padding:0.5rem 0.25rem;">
            <form method="POST" action="{{ url_for('knowledge_delete') }}" onsubmit="return confirm('Delete this knowledge source?');" style="margin:0;">
              <input type="hidden" name="filename" value="{{ row['filename'] }}">
              <button type="submit" class="danger">Delete</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No knowledge uploaded yet.</p>
{% endif %}

<div style="margin-top:1.5rem;">
  <h3 style="margin:0 0 0.35rem;">Import content from your website</h3>
  <p style="margin:0 0 0.75rem;color:var(--muted);">
    Paste your main website URL and TheoChat will crawl your site and import content to use in responses.
  </p>
  <form action="{{ url_for('import_site') }}" method="post" style="display:flex;flex-direction:column;gap:0.65rem;max-width:520px;">
    <input
      type="url"
      name="website_url"
      required
      placeholder="https://yourwebsite.com"
      style="flex:1;padding:0.5rem;border-radius:6px;border:1px solid var(--border);font-size:0.95rem;"
    />
    <button type="submit" class="primary" style="align-self:flex-start;padding:0.5rem 1rem;border-radius:6px;">Import website</button>
  </form>
</div>

{% endblock %}
