{% extends "base.html" %}
{% block content %}
<style>
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }
  th, td {
    border: 1px solid #e5e7eb;
    padding: 0.4rem 0.6rem;
    text-align: left;
    font-size: 0.95rem;
  }
  th {
    background: #f9fafb;
  }
  body.dark th {
    background: #0f172a;
  }
  .pill {
    display: inline-block;
    margin-right: 0.35rem;
  }
</style>

<h2 style="margin:0 0 .5rem;">Admin dashboard</h2>
<p style="margin:0;font-size:0.95rem;color:#6b7280;">Visible only to {{ ADMIN_EMAIL }}.</p>

<div style="margin-top:0.75rem;display:flex;gap:0.75rem;flex-wrap:wrap;">
  <span class="pill">Users: {{ stats.total_users }}</span>
  <span class="pill">Messages: {{ stats.total_messages }}</span>
  <span class="pill">Document chunks: {{ stats.total_chunks }}</span>
</div>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Email</th>
      <th>Business</th>
      <th>API key</th>
      <th>Subscription</th>
      <th>Messages</th>
      <th>Doc chunks</th>
    </tr>
  </thead>
  <tbody>
    {% for u in users %}
      <tr>
        <td>{{ u.id }}</td>
        <td>{{ u.email }}</td>
        <td>{{ u.business_name or "—" }}</td>
        <td><code>{{ u.business_api_key or "—" }}</code></td>
        <td>{{ u.stripe_subscription_status or "none" }}</td>
        <td>{{ u.message_count }}</td>
        <td>{{ u.chunk_count }}</td>
      </tr>
    {% endfor %}
    {% if not users %}
      <tr><td colspan="5">No users yet.</td></tr>
    {% endif %}
  </tbody>
</table>
{% endblock %}
