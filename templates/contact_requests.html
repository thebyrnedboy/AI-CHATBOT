{% extends "base.html" %}

{% block content %}
<div class="page">
  <div class="header-row" style="display:flex;justify-content:space-between;align-items:center;gap:0.75rem;margin-bottom:0.5rem;">
    <div>
      <h2 style="margin:0;">Contact requests</h2>
      <p style="margin:0;color:#6b7280;font-size:0.9rem;">Messages sent via your TheoChat widget's "Contact us" form.</p>
    </div>
  </div>

  {% if requests %}
    <div style="overflow-x:auto;">
      <table class="table" style="width:100%;border-collapse:collapse;font-size:0.95rem;">
        <thead>
          <tr style="text-align:left;border-bottom:1px solid #e5e7eb;">
            <th style="padding:0.5rem;">When</th>
            <th style="padding:0.5rem;">Source</th>
            <th style="padding:0.5rem;">Visitor name</th>
            <th style="padding:0.5rem;">Visitor email</th>
            <th style="padding:0.5rem;">Message</th>
          </tr>
        </thead>
        <tbody>
        {% for r in requests %}
          <tr style="border-bottom:1px solid #e5e7eb;">
            <td style="padding:0.5rem;">{{ r["created_at"] }}</td>
            <td style="padding:0.5rem;">{{ r["source"] or "widget" }}</td>
            <td style="padding:0.5rem;">{{ r["visitor_name"] or "-" }}</td>
            <td style="padding:0.5rem;">
              {% if r["visitor_email"] %}
                <a href="mailto:{{ r['visitor_email'] }}">{{ r["visitor_email"] }}</a>
              {% else %}
                -
              {% endif %}
            </td>
            <td style="padding:0.5rem;max-width:420px;white-space:pre-wrap;">{{ r["message"] }}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p style="margin:0;color:#6b7280;">No contact requests yet.</p>
  {% endif %}
</div>
{% endblock %}
